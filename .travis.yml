os: linux
group: edge
sudo: required
dist: trusty

stages:
  - test
  - name: test-verify
    if: branch != master
  - name: test-verify-deploy
    if: branch = master

language: java
jdk:
  - openjdk8
  - oraclejdk8
  - ibmjava8
  - openjdk12

script: true

install:
  - java -version
  - which javadoc
  - env | sort
  - jdk_switcher --help

jobs:
  include:
    - stage: test
      script:
        - ./mvnw -B -U clean test
      jdk:
        - openjdk8
        - oraclejdk8
        - ibmjava8

    - stage: test-verify
      script: ./mvnw -B -U clean verify
      jdk:
        - openjdk12

    - stage: test-verify-deploy
      script: ./mvnw -B -U clean verify
      jdk:
        - openjdk12


cache:
  directories:
    - $HOME/.m2
